<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>ðŸš— Ù‚ÙŠØ§Ø¯Ø© Ù…Ù† Ø¯Ø§Ø®Ù„ Ø§Ù„Ø³ÙŠØ§Ø±Ø©</title>
  <style>
    body { margin:0; background:#111; overflow:hidden; }
    canvas { display:block; width:100vw; height:100vh; }
    #hud {
      position:fixed; top:10px; left:10px; color:#fff; font-family:"Cairo",sans-serif;
      background:rgba(0,0,0,0.5); padding:8px 12px; border-radius:8px;
    }
  </style>
</head>
<body>
<div id="hud">Ø§Ù„Ø³Ø±Ø¹Ø©: <span id="speed">0</span> ÙƒÙ…/Ø³</div>
<canvas id="scene"></canvas>

<script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>
<script>
const speedEl=document.getElementById("speed");
const cv=document.getElementById("scene");
const renderer=new THREE.WebGLRenderer({canvas:cv,antialias:true});
renderer.setSize(window.innerWidth,window.innerHeight);
renderer.setPixelRatio(Math.min(window.devicePixelRatio,2));
renderer.shadowMap.enabled=true;

const scene=new THREE.Scene();
scene.background=new THREE.Color(0x87c5ff);

// Ø¥Ø¶Ø§Ø¡Ø©
const hemi=new THREE.HemisphereLight(0xffffff,0x444444,0.6);
scene.add(hemi);
const sun=new THREE.DirectionalLight(0xffffff,0.9);
sun.position.set(50,100,30);
sun.castShadow=true;
scene.add(sun);

// ÙƒØ§Ù…ÙŠØ±Ø§ Ø¯Ø§Ø®Ù„ÙŠØ©
const camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,0.1,1000);
camera.position.set(0,1.2,0.5); // Ù…ÙƒØ§Ù† Ø§Ù„Ø³Ø§Ø¦Ù‚
scene.add(camera);

// Ø£Ø±Ø¶ÙŠØ© ÙˆØ·Ø±ÙŠÙ‚
const ground=new THREE.Mesh(new THREE.PlaneGeometry(500,500),new THREE.MeshStandardMaterial({color:0x4a7a4a}));
ground.rotation.x=-Math.PI/2; ground.receiveShadow=true; scene.add(ground);

const road=new THREE.Mesh(new THREE.PlaneGeometry(8,200),new THREE.MeshStandardMaterial({color:0x333333}));
road.rotation.x=-Math.PI/2; road.position.z=-100; scene.add(road);

// Ø¯Ø±ÙƒØ³ÙŠÙˆÙ†
const steering=new THREE.Mesh(new THREE.TorusGeometry(0.25,0.05,16,32),new THREE.MeshStandardMaterial({color:0x222222}));
steering.position.set(0.3,0.9,0.8);
scene.add(steering);

// Ø­Ø§Ù„Ø© Ø§Ù„Ø³ÙŠØ§Ø±Ø©
const state={vx:0,vz:0,heading:0,steer:0};

// Ù…Ø¯Ø®Ù„Ø§Øª
const keys={w:false,s:false,a:false,d:false};
window.addEventListener("keydown",e=>{
  if(e.key==="w")keys.w=true;
  if(e.key==="s")keys.s=true;
  if(e.key==="a")keys.a=true;
  if(e.key==="d")keys.d=true;
});
window.addEventListener("keyup",e=>{
  if(e.key==="w")keys.w=false;
  if(e.key==="s")keys.s=false;
  if(e.key==="a")keys.a=false;
  if(e.key==="d")keys.d=false;
});

// ÙÙŠØ²ÙŠØ§Ø¡ Ù…Ø¨Ø³Ø·Ø©
function step(dt){
  if(keys.w) state.vz-=20*dt;
  if(keys.s) state.vz+=20*dt;
  if(keys.a) state.steer=Math.max(state.steer-1*dt,-0.5);
  if(keys.d) state.steer=Math.min(state.steer+1*dt,0.5);
  state.heading+=state.steer*dt*2;
  camera.position.z+=state.vz*dt;
  camera.rotation.y=state.heading;
  steering.rotation.z=state.steer*2; // Ø­Ø±ÙƒØ© Ø§Ù„Ø¯Ø±ÙƒØ³ÙŠÙˆÙ†
  const speed=Math.abs(state.vz*3.6);
  speedEl.textContent=Math.round(speed);
}

// Ø­Ù„Ù‚Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
let last=performance.now();
function loop(ts){
  const dt=(ts-last)/1000; last=ts;
  step(dt);
  renderer.render(scene,camera);
  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);

// Resize
window.addEventListener("resize",()=>{
  renderer.setSize(window.innerWidth,window.innerHeight);
  camera.aspect=window.innerWidth/window.innerHeight; camera.updateProjectionMatrix();
});
</script>
</body>
</html>
